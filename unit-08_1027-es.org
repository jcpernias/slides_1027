# -*- ispell-dictionary: "spanish" -*-
#+SETUPFILE: ./course-es.org

#+TITLE: {{{unit08}}}

#+PROPERTY: header-args:R :session *R-ts-intro*
#+PROPERTY: header-args:R+ :tangle yes
#+PROPERTY: header-args:R+ :exports both
#+PROPERTY: header-args:R+ :results output

#+begin_src R :exports none :tangle no :results silent
  ## load R libraries
  options(tidyverse.quiet = TRUE)
  library(tidyverse)
  library(readxl)
  library(zoo, warn.conflicts = FALSE)

  ## Set ggplot2 theme
  theme_set(theme_bw())

  theme_update(panel.border = element_blank(),
               axis.line.x = element_line(linewidth = 0.2),
               axis.line.y = element_line(linewidth = 0.2),
               text = element_text(size = 9))


  ## Read data
  ipc_db <- read_xlsx("data/IPCa.xlsx", range = "b9:b322",
                      col_names = "ipc")
  ipc <- zooreg(ipc_db$ipc, start = c(1997, 1), frequency = 12)

  ## Compute inflation rates
  lp <- log(ipc)
  infl <- 100 * diff(lp, lag = 12)
#+end_src


#+MATS: bib
#+begin_bibbox
- Wooldridge: ::  /Introducción a la Econometría/. Capítulo 10,
  secciones 10.1, 10.2, 10.4 y 10.5.
- Stock y Watson: ::  /Introducción a la Econometría/. Capítulo 14,
  secciones 14.1 a 14.5.
#+end_bibbox

* Introducción


** Datos de series temporales

- Una muestra de datos de *series temporales* está formada por
  observaciones de una o más variables *en periodos de tiempo
  consecutivos*.


** Comparación con datos de corte transversal

- Los datos no provienen de un *muestreo aleatorio*.

- El paso del tiempo proporciona un *orden* natural a las
  observaciones de series temporales.


** Series temporales regulares

- *Series temporales regulares*: el intervalo de tiempo que transcurre
  entre una observación y la siguiente es siempre el mismo: un año, un
  semestre, un cuatrimestre, un mes, etc.

- De acuerdo con la *frecuencia* con que se observan los valores de
  una variable, hablamos de series temporales anuales, trimestrales,
  mensuales, etc.

** Ejemplo: inflación interanual en España

Tasa interanual de inflación calculada a partir del IPC armonizado
general de España. Fuente: INE.

#+ATTR_LATEX: :font \scriptsize :align @{}l*{12}{@{\hspace{3mm}}>{$}r<{$}}@{} :booktabs t
|------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------|
|      | \text{Ene} | \text{Feb} | \text{Mar} | \text{Abr} | \text{May} | \text{Jun} | \text{Jul} | \text{Ago} | \text{Sep} | \text{Oct} | \text{Nov} | \text{Dic} |
|------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------|
| 2016 |       -0.4 |       -1.0 |       -1.0 |       -1.2 |       -1.1 |       -0.9 |       -0.7 |       -0.3 |        0.0 |        0.5 |        0.5 |        1.4 |
| 2017 |        2.9 |        3.0 |        2.1 |        2.6 |        2.0 |        1.6 |        1.7 |        2.0 |        1.8 |        1.7 |        1.8 |        1.2 |
| 2018 |        0.7 |        1.2 |        1.3 |        1.1 |        2.1 |        2.3 |        2.3 |        2.2 |        2.3 |        2.3 |        1.7 |        1.2 |
| 2019 |        1.0 |        1.1 |        1.3 |        1.6 |        0.9 |        0.6 |        0.6 |        0.4 |        0.2 |        0.2 |        0.5 |        0.8 |
| 2020 |        1.1 |        0.9 |        0.1 |       -0.7 |       -0.9 |       -0.3 |       -0.7 |       -0.6 |       -0.6 |       -0.9 |       -0.8 |       -0.6 |
| 2021 |        0.4 |       -0.1 |        1.2 |        2.0 |        2.4 |        2.5 |        2.9 |        3.3 |        4.0 |        5.4 |        5.5 |        6.6 |
| 2022 |        6.2 |        7.6 |        9.8 |        8.3 |        8.5 |       10.0 |       10.7 |       10.5 |        9.0 |        7.3 |        6.7 |        5.5 |
| 2023 |        5.9 |        6.0 |            |            |            |            |            |            |            |            |            |            |
|------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------|


** Gráfico de series temporales

Tasa interanual de inflación calculada a partir del IPC armonizado
general de España. Fuente: INE.

#+NAME: fig1
#+header: :width 4.0 :height 2.47 :family "Times" :R-dev-args encoding = "ISOLatin9.enc"
#+begin_src R :results output graphics file :exports results :file figures/infl.pdf
  autoplot(window(infl, start = "1999-1")) +
    scale_y_continuous(breaks = seq(0, 10, 2)) +
    scale_x_yearmon(breaks = seq(2000, 2023, 5), format = "%Y",
                    minor_breaks = seq(1999, 2023, 1)) +
    labs(x = NULL, y = NULL)
#+end_src
#+ATTR_LATEX: :centering t
#+RESULTS: fig1

** Principales dificultades

+ Muestras relativamente pequeñas.

+ Los procesos que determinan los valores que toma una serie temporal
  pueden cambiar con el paso del tiempo.

+ Un hecho que ocurra en un momento del tiempo puede tener influencia
  en sucesivos periodos, creando dependencia entre observaciones
  consecutivas de una serie temporal.


* Conceptos básicos

** Notación

- $y_t$: observación de la serie temporal $y$ en el periodo $t$.

- El índice $t$ va desde $1$, para el primer periodo en la muestra,
  hasta $T$, para el último.

** Retardos

- El *primer retardo* (/first lag/) de la serie $y$ es $y_{t-1}$, el
  valor que tomaba la variable el período anterior.

- De forma análoga, podemos definir el segundo y sucesivos retardos de
  la serie $y$: $y_{t-2}, y_{t-3}, \dots$


** Ejemplo: retardos

La serie anual $Y_t$ contiene los valores del PIB español a precios de
mercado desde el año 2000 hasta el 2008. Se mide en millones de euros.

#+ATTR_LATEX: :font \footnotesize :align @{}rr*{4}{@{\hspace{8mm}}r}@{} :booktabs t
|  Año | $t$ | $Y_{t}$       | $Y_{t-1}$     | $Y_{t-2}$     | $Y_{t-3}$    |
|------+-----+---------------+---------------+---------------+--------------|
| 2000 |   1 | \num{ 647851} | \text{---}    | \text{---}    | \text{---}   |
| 2001 |   2 | \num{ 700993} | \num{ 647851} | \text{---}    | \text{---}   |
| 2002 |   3 | \num{ 749552} | \num{ 700993} | \num{ 647851} | \text{---}   |
| 2003 |   4 | \num{ 802266} | \num{ 749552} | \num{ 700993} | \num{647851} |
| 2004 |   5 | \num{ 859437} | \num{ 802266} | \num{ 749552} | \num{700993} |
| 2005 |   6 | \num{ 927357} | \num{ 859437} | \num{ 802266} | \num{749552} |
| 2006 |   7 | \num{1003823} | \num{ 927357} | \num{ 859437} | \num{802266} |
| 2007 |   8 | \num{1075539} | \num{1003823} | \num{ 927357} | \num{859437} |
| 2008 |   9 | \num{1109541} | \num{1075539} | \num{1003823} | \num{927357} |

** Diferencias

- La *diferencia* de la serie $y_t$ es $\incr y_t = y_{t} - y_{t-1}$,
  el incremento de la variable de un periodo a otro.

- Podemos calcular $\mathit{gy}_t$, la tasa porcentual de crecimiento
  de $y_t$, a partir de la diferencia y del primer retardo:
  #+begin_export latex
  \[
    \mathit{gy}_t = 100 \frac{\incr y_t}{y_{t-1}}
  \]
  #+end_export

** Ejemplo: diferencias

Diferencia y tasa de crecimiento de  $Y_t$.

#+ATTR_LATEX: :font \footnotesize :align @{}rr*{4}{@{\hspace{8mm}}r}@{} :booktabs t
|  Año | $t$ | $Y_{t}$       | $Y_{t-1}$     | $\incr Y_{t}$ | $gY_{t}$   |
|------+-----+---------------+---------------+---------------+------------|
| 2000 |   1 | \num{ 647851} | \text{---}    | \text{---}    | \text{---} |
| 2001 |   2 | \num{ 700993} | \num{ 647851} | \num{53142}   | \num{8.2}  |
| 2002 |   3 | \num{ 749552} | \num{ 700993} | \num{48559}   | \num{6.9}  |
| 2003 |   4 | \num{ 802266} | \num{ 749552} | \num{52714}   | \num{7.0}  |
| 2004 |   5 | \num{ 859437} | \num{ 802266} | \num{57171}   | \num{7.1}  |
| 2005 |   6 | \num{ 927357} | \num{ 859437} | \num{67920}   | \num{7.9}  |
| 2006 |   7 | \num{1003823} | \num{ 927357} | \num{76466}   | \num{8.2}  |
| 2007 |   8 | \num{1075539} | \num{1003823} | \num{71716}   | \num{7.1}  |
| 2008 |   9 | \num{1109541} | \num{1075539} | \num{34002}   | \num{3.2}  |

** Logaritmos y tasas de crecimiento

- En el análisis de series temporales es muy común usar las variables
  en logaritmos.

- Es muy frecuente calcular la tasa de crecimiento de $y_t$ usando la
  diferencia del logaritmo de $y_t$:
  #+begin_export latex
  \[
    \mathit{gy}_t \approx 100 \incr \log(y_t)
  \]
  #+end_export

** Ejemplo: logaritmos y tasas de crecimiento

No hay grandes diferencias entre las diferentes formas de calcular las
tasas de crecimiento.

#+ATTR_LATEX: :font \footnotesize :align @{}rr*{2}{@{\hspace{15mm}}r@{\hspace{2mm}}r}@{} :booktabs t
|  Año | $t$ | $Y_{t}$       | $100 \incr Y_{t} / Y_{t-1}$ | $\log(Y_{t})$ | $100 \incr \log(Y_{t})$ |
|------+-----+---------------+-----------------------------+---------------+-------------------------|
| 2000 |   1 | \num{ 647851} | \text{---}                  | \num{13.38}   | \text{---}              |
| 2001 |   2 | \num{ 700993} | \num{8.2}                   | \num{13.46}   | \num{7.9}               |
| 2002 |   3 | \num{ 749552} | \num{6.9}                   | \num{13.53}   | \num{6.7}               |
| 2003 |   4 | \num{ 802266} | \num{7.0}                   | \num{13.60}   | \num{6.8}               |
| 2004 |   5 | \num{ 859437} | \num{7.1}                   | \num{13.66}   | \num{6.9}               |
| 2005 |   6 | \num{ 927357} | \num{7.9}                   | \num{13.74}   | \num{7.6}               |
| 2006 |   7 | \num{1003823} | \num{8.2}                   | \num{13.82}   | \num{7.9}               |
| 2007 |   8 | \num{1075539} | \num{7.1}                   | \num{13.89}   | \num{6.9}               |
| 2008 |   9 | \num{1109541} | \num{3.2}                   | \num{13.92}   | \num{3.1}               |


** Procesos estocásticos

- Los modelos estadísticos para estudiar series temporales se basa en
  el concepto de *proceso estocástico*.

- Un *proceso estocástico* es una secuencia de variables aleatorias
  observadas en periodos consecutivos de tiempo: $\{y_1, y_2, \dots,
  y_T\}$.

- Notación abreviada: $\{y_t\!: t =  1, 2, \dots, T\}$.


** Esperanza



** Correlación serial


** Autocovarianzas


** Coeficientes de autocorrelación


** Autocorrelograma


** Estacionariedad: concepto


** Estacionariedad: definición


** Dependencia débil



* COMMENT Características de las series temporales


* COMMENT Ejemplos

- PIB y agregados macro.

- Índices de precios.

- Otros números índices.

- Tipos de interés.

- Cotizaciones de bolsa.

- Indicadores de turismo.


* COMMENT Características de las series temporales

- Dependencia temporal: en general, lo que ocurra mañana será muy
  parecido a lo que ocurre hoy. Base para muchos métodos de
  predicción: extrapolación sofisticada de lo que ocurrió en el
  pasado. Autocorrelación.

- Tendencias.

- Uso de logaritmos.

- Diferencias y retardos.

- Estacionalidad.


* COMMENT Modelo autorregresivos

- Modelo AR(1). Estacionariedad. Diferencias.

- Predicción y errores de predicción. Predicción con diferencias.

- Modelo AR(p).

- Predicción.

- Selección del número de retardos


* COMMENT Tendencias, estacionalidad y análisis de intervención

- Tendencias deterministas. Tendencia lineal. Tendencias con datos en
  logaritmos.

- Estacionalidad.

- Análisis de intervención. Variables ficticias: impulso, escalón, etc.
